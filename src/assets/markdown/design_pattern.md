# 软件开发-设计模式

>更新于2022年7月19日

`设计模式`是软件开发人员在软件开发过程中面临的一般问题的解决方案。 这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。 设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。 使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。

## 1. 设计模式原则

- 降低复杂度
- 降低耦合性：耦合度越大，当一个类发生改变时，对另一个类的影响也越大。
- 增加稳定性

#### 单一原则

简单地说就是`一个类只做一件事`，这个设计原则备受争议却又极其重要。每个类都有比较单一的职责，软件设计真正要做的许多内容，就是发现职责并把那些职责相互分离，就是抽象的能力。注意，单一职责原则并不是一个类只能有一个函数，而是说这个类中的函数所做的工作是高度相关的，也就是高内聚。

优点：

- 类的复杂性降低，实现什么职责都有清晰明确的定义。
- 可读性提高，复杂性降低，那当然可读性提高了。
- 可维护性提高，可读性提高了，那当然更容易维护了。
- 变更引起的风险降低，变更是必不可少的，如果接口的单一职责做得好，一个接口修改只对应的实现类有影响，对其他的接口无影响，这对系统的扩展性、维护性都有非常大的帮助。

#### 开闭原则

开闭原则的意思是：`对扩展开放，对修改关闭`。个软件实体类，模块和函数应该对扩展开放，对修改关闭。在软件的生命周期内，因为变化、升级和维护等原因，需要对软件原有的代码进行修改时，可能会给旧代码引入错误。因此，当软件需要变化时，我们应该尽量通过扩展的方式来实现变化，而不是通过修改已有的代码来实现。想要达到这样的效果，我们需要使用接口和抽象类。

#### 里氏替换原则

里氏替换原则本质就是`继承`、`多态`的应用。里氏替换原则通俗的来讲就是：`子类可以扩展父类的功能，但不能改变父类原有的功能`。如果一个类被其他的类所`继承`或`依赖`，则当这个类需要修改时，必须考虑到所有的`子类、被依赖项`，并且父类修改后，所有涉及到子类的功能都有可能会产生故障。 

- 子类可以实现父类的抽象方法，但不能覆盖父类的非抽象方法。
- 子类中可以增加自己特有的方法。
- 当子类的方法重载父类的方法时，方法的参数类型要比父类方法的参数类型更宽松（接口）。
- 当子类的方法实现父类的抽象方法时，方法的返回值要比父类更严格（接口实现类）。

#### 依赖倒置原则

抽象不应该依赖细节，细节应该依赖于抽象，说白了，就是要针对接口编程，不要对实现编程。

传递依赖关系有三种方式，以上的例子中使用的方法是接口传递，另外还有两种传递方式：构造方法传递和 setter 方法传递，相信用过 Dagger、Spring 框架的，对依赖的传递方式一定不会陌生。 在实际编程中，我们一般需要做到如下：

- 低层模块尽量都要有抽象类或接口，或者两者都有。
- 变量的声明类型尽量是抽象类或接口。
- 使用继承时遵循里氏替换原则。 依赖倒置原则的核心就是要我们面向接口编程。

#### 接口隔离原则

接口隔离原则注重对接口依赖的隔离，没有客户(client)应该被迫依赖于它不使用方法。接口隔离原则拆分非常庞大臃肿的接口成为更小的和更具体的接口，这样客户将会只需要知道他们感兴趣的方法。

- 接口尽量小，但是要有限度。对接口进行细化可以提高程序设计灵活性是不挣的事实，但是如果过小，则会造成接口数量过多，使设计复杂化。所以一定要适度。
- 为依赖接口的类定制服务，只暴露给调用的类它需要的方法，它不需要的方法则隐藏起来。只有专注地为一个模块提供定制服务，才能建立最小的依赖关系。
- 提高内聚，减少对外交互。使接口用最少的方法去完成最多的事情。 运用接口隔离原则，一定要适度，接口设计的过大或过小都不好。设计接口的时候，只有多花些时间去思考和筹划，才能准确地实践这一原则。

#### 最少知识原则

一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。a.b.Method()违反了此定律，而a.Method()不违反此定律。一个简单例子是，人可以命令一条狗行走（walk），但是不应该直接指挥狗的腿行走，应该由狗去指挥控制它的腿如何行走。一个类应该对自己需要耦合或者调用的类知道得最少，这有点类似于接口隔离原则中的最小接口的概念。

## 2. 依赖注入

所谓[依赖注入](https://zh.m.wikipedia.org/zh-hans/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5)，是指程序运行过程中，如果需要调用另一个对象协助时，无须在代码中创建被调用者，而是依赖于外部的注入。


